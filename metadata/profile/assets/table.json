{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "allOf": [{ "$ref": "#/$defs/TableSchema" }],
  "$defs": {
    "TableSchema": {
      "type": "object",
      "properties": {
        "$schema": { "$ref": "#/$defs/MetaSchema" },
        "required": { "$ref": "#/$defs/Required" },
        "properties": { "$ref": "#/$defs/Properties" },
        "missingValues": { "$ref": "#/$defs/MissingValues" },
        "primaryKey": { "$ref": "#/$defs/PrimaryKey" },
        "uniqueKeys": { "$ref": "#/$defs/UniqueKeys" },
        "foreignKeys": { "$ref": "#/$defs/ForeignKeys" }
      }
    },
    "MetaSchema": {
      "type": "string",
      "pattern": "table.json$"
    },
    "Required": {
      "type": "array",
      "items": { "type": "string" }
    },
    "Properties": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/$defs/Column"
      }
    },
    "Column": {
      "required": ["type"],
      "properties": {
        "type": {
          "enum": ["string", "integer", "number", "boolean", "array", "object"]
        }
      },
      "allOf": [
        {
          "if": { "properties": { "type": { "const": "integer" } } },
          "then": { "$ref": "#/$defs/IntegerColumnGroup" }
        },
        {
          "if": { "properties": { "type": { "const": "number" } } },
          "then": { "$ref": "#/$defs/NumberColumnGroup" }
        },
        {
          "if": { "properties": { "type": { "const": "boolean" } } },
          "then": { "$ref": "#/$defs/BooleanColumnGroup" }
        },
        {
          "if": { "properties": { "type": { "const": "string" } } },
          "then": { "$ref": "#/$defs/StringColumnGroup" }
        },
        {
          "if": { "properties": { "type": { "const": "array" } } },
          "then": { "$ref": "#/$defs/ArrayColumnGroup" }
        },
        {
          "if": { "properties": { "type": { "const": "object" } } },
          "then": { "$ref": "#/$defs/ObjectColumnGroup" }
        }
      ]
    },
    "StringColumnGroup": {
      "properties": {
        "format": {
          "enum": [
            "list",
            "hex",
            "base64",
            "email",
            "uuid",
            "url",
            "date-time",
            "date",
            "time",
            "duration",
            "wkt",
            "wkb"
          ]
        }
      },
      "allOf": [
        {
          "if": { "not": { "required": ["format"] } },
          "then": { "$ref": "#/$defs/StringColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "list" } } },
          "then": { "$ref": "#/$defs/ListColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "hex" } } },
          "then": { "$ref": "#/$defs/HexColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "base64" } } },
          "then": { "$ref": "#/$defs/Base64Column" }
        },
        {
          "if": { "properties": { "format": { "const": "email" } } },
          "then": { "$ref": "#/$defs/EmailColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "uuid" } } },
          "then": { "$ref": "#/$defs/UuidColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "url" } } },
          "then": { "$ref": "#/$defs/UrlColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "date-time" } } },
          "then": { "$ref": "#/$defs/DatetimeColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "date" } } },
          "then": { "$ref": "#/$defs/DateColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "time" } } },
          "then": { "$ref": "#/$defs/TimeColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "duration" } } },
          "then": { "$ref": "#/$defs/DurationColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "wkt" } } },
          "then": { "$ref": "#/$defs/WktColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "wkb" } } },
          "then": { "$ref": "#/$defs/WkbColumn" }
        }
      ]
    },
    "IntegerColumnGroup": {
      "properties": {
        "format": {
          "enum": ["year"]
        }
      },
      "allOf": [
        {
          "if": { "not": { "required": ["format"] } },
          "then": { "$ref": "#/$defs/IntegerColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "year" } } },
          "then": { "$ref": "#/$defs/YearColumn" }
        }
      ]
    },
    "NumberColumnGroup": {
      "allOf": [
        {
          "if": { "not": { "required": ["format"] } },
          "then": { "$ref": "#/$defs/NumberColumn" }
        }
      ]
    },
    "BooleanColumnGroup": {
      "allOf": [
        {
          "if": { "not": { "required": ["format"] } },
          "then": { "$ref": "#/$defs/BooleanColumn" }
        }
      ]
    },
    "ArrayColumnGroup": {
      "allOf": [
        {
          "if": { "not": { "required": ["format"] } },
          "then": { "$ref": "#/$defs/ArrayColumn" }
        }
      ]
    },
    "ObjectColumnGroup": {
      "properties": {
        "format": {
          "enum": ["geojson", "topojson"]
        }
      },
      "allOf": [
        {
          "if": { "not": { "required": ["format"] } },
          "then": { "$ref": "#/$defs/ObjectColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "geojson" } } },
          "then": { "$ref": "#/$defs/GeojsonColumn" }
        },
        {
          "if": { "properties": { "format": { "const": "topojson" } } },
          "then": { "$ref": "#/$defs/TopojsonColumn" }
        }
      ]
    },
    "BaseColumn": {
      "type": "object",
      "properties": {
        "title": { "$ref": "#/$defs/Title" },
        "description": { "$ref": "#/$defs/Description" },
        "rdfType": { "$ref": "#/$defs/RdfType" }
      }
    },
    "StringColumn": {
      "allOf": [{ "$ref": "#/$defs/BaseColumn" }],
      "properties": {
        "type": { "const": "string" },
        "enum": { "$ref": "#/$defs/StringEnum" },
        "pattern": { "$ref": "#/$defs/Pattern" },
        "categories": { "$ref": "#/$defs/StringCategories" },
        "missingValues": { "$ref": "#/$defs/StringMissingValues" },
        "examples": { "$ref": "#/$defs/StringExamples" },
        "minLength": { "$ref": "#/$defs/MinLength" },
        "maxLength": { "$ref": "#/$defs/MaxLength" }
      }
    },
    "IntegerColumn": {
      "allOf": [{ "$ref": "#/$defs/BaseColumn" }],
      "properties": {
        "type": { "const": "integer" },
        "enum": { "$ref": "#/$defs/IntegerEnum" },
        "minimum": { "$ref": "#/$defs/IntegerMinimum" },
        "maximum": { "$ref": "#/$defs/IntegerMaximum" },
        "exclusiveMinimum": { "$ref": "#/$defs/IntegerExclusiveMinimum" },
        "exclusiveMaximum": { "$ref": "#/$defs/IntegerExclusiveMaximum" },
        "multipleOf": { "$ref": "#/$defs/IntegerMultipleOf" },
        "categories": { "$ref": "#/$defs/IntegerCategories" },
        "missingValues": { "$ref": "#/$defs/IntegerMissingValues" },
        "examples": { "$ref": "#/$defs/IntegerExamples" },
        "groupChar": { "$ref": "#/$defs/GroupChar" },
        "withText": { "type": "boolean" }
      }
    },
    "NumberColumn": {
      "allOf": [{ "$ref": "#/$defs/BaseColumn" }],
      "properties": {
        "type": { "const": "number" },
        "enum": { "$ref": "#/$defs/NumberEnum" },
        "minimum": { "$ref": "#/$defs/NumberMinimum" },
        "maximum": { "$ref": "#/$defs/NumberMaximum" },
        "exclusiveMinimum": { "$ref": "#/$defs/NumberExclusiveMinimum" },
        "exclusiveMaximum": { "$ref": "#/$defs/NumberExclusiveMaximum" },
        "multipleOf": { "$ref": "#/$defs/NumberMultipleOf" },
        "missingValues": { "$ref": "#/$defs/NumberMissingValues" },
        "examples": { "$ref": "#/$defs/NumberExamples" },
        "decimalChar": { "$ref": "#/$defs/DecimalChar" },
        "groupChar": { "$ref": "#/$defs/GroupChar" },
        "withText": { "type": "boolean" }
      }
    },
    "BooleanColumn": {
      "allOf": [{ "$ref": "#/$defs/BaseColumn" }],
      "properties": {
        "type": { "const": "boolean" },
        "enum": { "$ref": "#/$defs/BooleanEnum" },
        "trueValues": { "$ref": "#/$defs/TrueValues" },
        "falseValues": { "$ref": "#/$defs/FalseValues" },
        "missingValues": { "$ref": "#/$defs/BooleanMissingValues" },
        "examples": { "$ref": "#/$defs/BooleanExamples" }
      }
    },
    "ObjectColumn": {
      "allOf": [
        { "$ref": "#/$defs/BaseColumn" },
        { "$ref": "https://json-schema.org/draft/2020-12/schema" }
      ],
      "type": "object",
      "properties": {
        "missingValues": { "$ref": "#/$defs/ObjectMissingValues" },
        "examples": { "$ref": "#/$defs/ObjectExamples" }
      }
    },
    "ArrayColumn": {
      "allOf": [
        { "$ref": "#/$defs/BaseColumn" },
        { "$ref": "https://json-schema.org/draft/2020-12/schema" }
      ],
      "type": "array",
      "properties": {
        "missingValues": { "$ref": "#/$defs/ArrayMissingValues" },
        "examples": { "$ref": "#/$defs/ArrayExamples" }
      }
    },
    "ListColumn": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "list" },
        "itemType": { "$ref": "#/$defs/ListItemType" },
        "delimiter": { "$ref": "#/$defs/ListDelimiter" }
      }
    },
    "Base64Column": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "base64" }
      }
    },
    "HexColumn": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "hex" }
      }
    },
    "EmailColumn": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "email" }
      }
    },
    "UuidColumn": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "uuid" }
      }
    },
    "UrlColumn": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "url" }
      }
    },
    "DatetimeColumn": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "date-time" },
        "temporalFormat": { "$ref": "#/$defs/TemporalFormat" }
      }
    },
    "DateColumn": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "date" },
        "temporalFormat": { "$ref": "#/$defs/TemporalFormat" }
      }
    },
    "TimeColumn": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "time" },
        "temporalFormat": { "$ref": "#/$defs/TemporalFormat" }
      }
    },
    "DurationColumn": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "duration" }
      }
    },
    "WktColumn": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "wkt" }
      }
    },
    "WkbColumn": {
      "allOf": [{ "$ref": "#/$defs/StringColumn" }],
      "properties": {
        "format": { "const": "wkb" }
      }
    },
    "YearColumn": {
      "allOf": [{ "$ref": "#/$defs/IntegerColumn" }],
      "properties": {
        "format": { "const": "year" }
      }
    },
    "GeojsonColumn": {
      "allOf": [{ "$ref": "#/$defs/ObjectColumn" }],
      "properties": {
        "format": { "const": "geojson" }
      }
    },
    "TopojsonColumn": {
      "allOf": [{ "$ref": "#/$defs/ObjectColumn" }],
      "properties": {
        "format": { "const": "topojson" }
      }
    },
    "Title": {
      "type": "string"
    },
    "Description": {
      "type": "string"
    },
    "RdfType": {
      "type": "string",
      "format": "uri"
    },
    "Pattern": {
      "type": "string",
      "format": "regex"
    },
    "MinLength": {
      "type": "integer",
      "minimum": 0
    },
    "MaxLength": {
      "type": "integer",
      "minimum": 0
    },
    "TrueValues": {
      "type": "array",
      "items": { "type": "string" }
    },
    "FalseValues": {
      "type": "array",
      "items": { "type": "string" }
    },
    "IntegerMinimum": {
      "type": "integer"
    },
    "IntegerMaximum": {
      "type": "integer"
    },
    "IntegerExclusiveMinimum": {
      "type": "integer"
    },
    "IntegerExclusiveMaximum": {
      "type": "integer"
    },
    "IntegerMultipleOf": {
      "type": "integer",
      "minimum": 1
    },
    "NumberMinimum": {
      "type": "number"
    },
    "NumberMaximum": {
      "type": "number"
    },
    "NumberExclusiveMinimum": {
      "type": "number"
    },
    "NumberExclusiveMaximum": {
      "type": "number"
    },
    "NumberMultipleOf": {
      "type": "number",
      "exclusiveMinimum": 0
    },
    "DecimalChar": {
      "type": "string",
      "maxLength": 1
    },
    "GroupChar": {
      "type": "string",
      "maxLength": 1
    },
    "TemporalFormat": {
      "type": "string"
    },
    "ListDelimiter": {
      "type": "string",
      "maxLength": 1
    },
    "ListItemType": {
      "enum": [
        "string",
        "integer",
        "number",
        "boolean",
        "datetime",
        "date",
        "time"
      ]
    },
    "IntegerEnum": {
      "type": "array",
      "items": { "type": "integer" }
    },
    "NumberEnum": {
      "type": "array",
      "items": { "type": "number" }
    },
    "BooleanEnum": {
      "type": "array",
      "items": { "type": "boolean" }
    },
    "StringEnum": {
      "type": "array",
      "items": { "type": "string" }
    },
    "PrimaryKey": {
      "type": "array",
      "items": { "type": "string" },
      "minItems": 1
    },
    "UniqueKeys": {
      "type": "array",
      "items": { "$ref": "#/$defs/UniqueKey" },
      "minItems": 1
    },
    "UniqueKey": {
      "type": "array",
      "items": { "type": "string" },
      "minItems": 1
    },
    "ForeignKeys": {
      "type": "array",
      "items": { "$ref": "#/$defs/ForeignKey" },
      "minItems": 1
    },
    "ForeignKey": {
      "type": "object",
      "required": ["columns", "reference"],
      "properties": {
        "columns": { "$ref": "#/$defs/ForeignKeyColumns" },
        "reference": { "$ref": "#/$defs/ForeignKeyReference" }
      }
    },
    "ForeignKeyReference": {
      "type": "object",
      "required": ["columns"],
      "properties": {
        "resource": { "type": "string" },
        "columns": { "$ref": "#/$defs/ForeignKeyColumns" }
      }
    },
    "ForeignKeyColumns": {
      "type": "array",
      "items": { "type": "string" }
    },
    "MissingValues": {
      "type": "array",
      "items": {
        "oneOf": [
          { "type": ["string", "integer", "number", "boolean"] },
          {
            "type": "object",
            "properties": {
              "value": { "type": ["string", "integer", "number", "boolean"] },
              "label": { "type": "string" }
            }
          }
        ]
      }
    },
    "StringMissingValues": {
      "type": "array",
      "items": {
        "oneOf": [
          { "type": "string" },
          {
            "type": "object",
            "properties": {
              "value": { "type": "string" },
              "label": { "type": "string" }
            }
          }
        ]
      }
    },
    "IntegerMissingValues": {
      "type": "array",
      "items": {
        "oneOf": [
          { "type": ["string", "integer"] },
          {
            "type": "object",
            "properties": {
              "value": { "type": ["string", "integer"] },
              "label": { "type": "string" }
            }
          }
        ]
      }
    },
    "NumberMissingValues": {
      "type": "array",
      "items": {
        "oneOf": [
          { "type": ["string", "number"] },
          {
            "type": "object",
            "properties": {
              "value": { "type": ["string", "number"] },
              "label": { "type": "string" }
            }
          }
        ]
      }
    },
    "BooleanMissingValues": {
      "type": "array",
      "items": {
        "oneOf": [
          { "type": ["string", "boolean"] },
          {
            "type": "object",
            "properties": {
              "value": { "type": ["string", "boolean"] },
              "label": { "type": "string" }
            }
          }
        ]
      }
    },
    "ArrayMissingValues": {
      "type": "array",
      "items": {
        "oneOf": [
          { "type": ["string", "array"] },
          {
            "type": "object",
            "properties": {
              "value": { "type": ["string", "array"] },
              "label": { "type": "string" }
            }
          }
        ]
      }
    },
    "ObjectMissingValues": {
      "type": "array",
      "items": {
        "oneOf": [
          { "type": ["string", "object"] },
          {
            "type": "object",
            "properties": {
              "value": { "type": ["string", "object"] },
              "label": { "type": "string" }
            }
          }
        ]
      }
    },
    "StringCategories": {
      "type": "array",
      "items": {
        "oneOf": [
          { "type": "string" },
          {
            "type": "object",
            "properties": {
              "value": { "type": "string" },
              "label": { "type": "string" }
            }
          }
        ]
      }
    },
    "IntegerCategories": {
      "type": "array",
      "items": {
        "oneOf": [
          { "type": "integer" },
          {
            "type": "object",
            "properties": {
              "value": { "type": "integer" },
              "label": { "type": "string" }
            }
          }
        ]
      }
    },
    "StringExamples": {
      "type": "array",
      "items": { "type": "string" }
    },
    "IntegerExamples": {
      "type": "array",
      "items": { "type": "integer" }
    },
    "NumberExamples": {
      "type": "array",
      "items": { "type": "number" }
    },
    "BooleanExamples": {
      "type": "array",
      "items": { "type": "boolean" }
    },
    "ArrayExamples": {
      "type": "array",
      "items": { "type": "array" }
    },
    "ObjectExamples": {
      "type": "array",
      "items": { "type": "object" }
    }
  }
}
