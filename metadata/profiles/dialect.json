{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "allOf": [{ "$ref": "#/$defs/Dialect" }],
  "$defs": {
    "Dialect": {
      "properties": {
        "format": {
          "enum": [
            "csv",
            "tsv",
            "json",
            "jsonl",
            "xlsx",
            "ods",
            "parquet",
            "arrow",
            "sqlite"
          ]
        }
      },
      "allOf": [
        {
          "if": { "properties": { "format": { "const": "csv" } } },
          "then": { "$ref": "#/$defs/CsvDialect" }
        },
        {
          "if": { "properties": { "format": { "const": "tsv" } } },
          "then": { "$ref": "#/$defs/TsvDialect" }
        },
        {
          "if": { "properties": { "format": { "const": "json" } } },
          "then": { "$ref": "#/$defs/JsonDialect" }
        },
        {
          "if": { "properties": { "format": { "const": "jsonl" } } },
          "then": { "$ref": "#/$defs/JsonlDialect" }
        },
        {
          "if": { "properties": { "format": { "const": "xlsx" } } },
          "then": { "$ref": "#/$defs/XlsxDialect" }
        },
        {
          "if": { "properties": { "format": { "const": "ods" } } },
          "then": { "$ref": "#/$defs/OdsDialect" }
        },
        {
          "if": { "properties": { "format": { "const": "parquet" } } },
          "then": { "$ref": "#/$defs/ParquetDialect" }
        },
        {
          "if": { "properties": { "format": { "const": "arrow" } } },
          "then": { "$ref": "#/$defs/ArrowDialect" }
        },
        {
          "if": { "properties": { "format": { "const": "sqlite" } } },
          "then": { "$ref": "#/$defs/SqliteDialect" }
        },
        {
          "if": { "not": { "required": ["format"] } },
          "then": { "$ref": "#/$defs/CustomDialect" }
        }
      ]
    },
    "BaseDialect": {
      "type": "object",
      "properties": {
        "$schema": { "$ref": "#/$defs/Profile" },
        "title": { "$ref": "#/$defs/Title" },
        "description": { "$ref": "#/$defs/Description" }
      }
    },
    "CsvDialect": {
      "allOf": [{ "$ref": "#/$defs/BaseDialect" }],
      "required": ["format"],
      "properties": {
        "format": { "const": "csv" },
        "delimiter": { "$ref": "#/$defs/Delimiter" },
        "lineTerminator": { "$ref": "#/$defs/LineTerminator" },
        "quoteChar": { "$ref": "#/$defs/QuoteChar" },
        "nullSequence": { "$ref": "#/$defs/NullSequence" },
        "headerRows": { "$ref": "#/$defs/HeaderRows" },
        "headerJoin": { "$ref": "#/$defs/HeaderJoin" },
        "commentRows": { "$ref": "#/$defs/CommentRows" },
        "commentPrefix": { "$ref": "#/$defs/CommentPrefix" },
        "columnNames": { "$ref": "#/$defs/ColumnNames" }
      }
    },
    "TsvDialect": {
      "allOf": [{ "$ref": "#/$defs/BaseDialect" }],
      "required": ["format"],
      "properties": {
        "format": { "const": "tsv" },
        "lineTerminator": { "$ref": "#/$defs/LineTerminator" },
        "nullSequence": { "$ref": "#/$defs/NullSequence" },
        "headerRows": { "$ref": "#/$defs/HeaderRows" },
        "headerJoin": { "$ref": "#/$defs/HeaderJoin" },
        "commentRows": { "$ref": "#/$defs/CommentRows" },
        "commentPrefix": { "$ref": "#/$defs/CommentPrefix" },
        "columnNames": { "$ref": "#/$defs/ColumnNames" }
      }
    },
    "JsonDialect": {
      "allOf": [{ "$ref": "#/$defs/BaseDialect" }],
      "required": ["format"],
      "properties": {
        "format": { "const": "json" },
        "jsonPointer": { "$ref": "#/$defs/JsonPointer" },
        "rowType": { "$ref": "#/$defs/RowType" },
        "headerRows": { "$ref": "#/$defs/HeaderRows" },
        "headerJoin": { "$ref": "#/$defs/HeaderJoin" },
        "commentRows": { "$ref": "#/$defs/CommentRows" },
        "commentPrefix": { "$ref": "#/$defs/CommentPrefix" },
        "columnNames": { "$ref": "#/$defs/ColumnNames" }
      }
    },
    "JsonlDialect": {
      "allOf": [{ "$ref": "#/$defs/BaseDialect" }],
      "required": ["format"],
      "properties": {
        "format": { "const": "jsonl" },
        "rowType": { "$ref": "#/$defs/RowType" },
        "headerRows": { "$ref": "#/$defs/HeaderRows" },
        "headerJoin": { "$ref": "#/$defs/HeaderJoin" },
        "commentRows": { "$ref": "#/$defs/CommentRows" },
        "commentPrefix": { "$ref": "#/$defs/CommentPrefix" },
        "columnNames": { "$ref": "#/$defs/ColumnNames" }
      }
    },
    "XlsxDialect": {
      "allOf": [{ "$ref": "#/$defs/BaseDialect" }],
      "required": ["format"],
      "properties": {
        "format": { "const": "xlxs" },
        "sheetName": { "$ref": "#/$defs/SheetName" },
        "sheetNumber": { "$ref": "#/$defs/SheetNumber" },
        "headerRows": { "$ref": "#/$defs/HeaderRows" },
        "headerJoin": { "$ref": "#/$defs/HeaderJoin" },
        "commentRows": { "$ref": "#/$defs/CommentRows" },
        "commentPrefix": { "$ref": "#/$defs/CommentPrefix" },
        "columnNames": { "$ref": "#/$defs/ColumnNames" }
      }
    },
    "OdsDialect": {
      "allOf": [{ "$ref": "#/$defs/BaseDialect" }],
      "required": ["format"],
      "properties": {
        "format": { "const": "ods" },
        "sheetName": { "$ref": "#/$defs/SheetName" },
        "sheetNumber": { "$ref": "#/$defs/SheetNumber" },
        "headerRows": { "$ref": "#/$defs/HeaderRows" },
        "headerJoin": { "$ref": "#/$defs/HeaderJoin" },
        "commentRows": { "$ref": "#/$defs/CommentRows" },
        "commentPrefix": { "$ref": "#/$defs/CommentPrefix" },
        "columnNames": { "$ref": "#/$defs/ColumnNames" }
      }
    },
    "ParquetDialect": {
      "allOf": [{ "$ref": "#/$defs/BaseDialect" }],
      "required": ["format"],
      "properties": {
        "format": { "const": "parquet" }
      }
    },
    "ArrowDialect": {
      "allOf": [{ "$ref": "#/$defs/BaseDialect" }],
      "required": ["format"],
      "properties": {
        "format": { "const": "arrow" }
      }
    },
    "SqliteDialect": {
      "allOf": [{ "$ref": "#/$defs/BaseDialect" }],
      "required": ["format"],
      "properties": {
        "format": { "const": "sqlite" },
        "tableName": { "$ref": "#/$defs/TableName" }
      }
    },
    "CustomDialect": {
      "allOf": [{ "$ref": "#/$defs/BaseDialect" }],
      "properties": {
        "name": { "$ref": "#/$defs/Name" }
      }
    },
    "Profile": {
      "$ref": "#/$defs/ExternalPath"
    },
    "ExternalPath": {
      "type": "string",
      "pattern": "^https?://"
    },
    "Name": {
      "type": "string"
    },
    "Title": {
      "type": "string"
    },
    "Description": {
      "type": "string"
    },
    "Delimiter": {
      "type": "string",
      "maxLength": 1
    },
    "LineTerminator": {
      "type": "string"
    },
    "QuoteChar": {
      "type": "string"
    },
    "NullSequence": {
      "type": "string"
    },
    "Header": {
      "type": "boolean"
    },
    "HeaderRows": {
      "oneOf": [
        { "const": false },
        {
          "type": "array",
          "items": { "type": "integer", "minimum": 1 },
          "minItems": 1
        }
      ]
    },
    "HeaderJoin": {
      "type": "string"
    },
    "CommentRows": {
      "type": "array",
      "items": { "type": "integer", "minimum": 1 },
      "minItems": 1
    },
    "CommentPrefix": {
      "type": "string"
    },
    "ColumnNames": {
      "type": "array",
      "items": { "type": "string" },
      "minItems": 1
    },
    "JsonPointer": {
      "type": "string",
      "format": "json-pointer"
    },
    "RowType": {
      "enum": ["array", "object"]
    },
    "SheetNumber": {
      "type": "integer"
    },
    "SheetName": {
      "type": "string"
    },
    "TableName": {
      "type": "string"
    }
  }
}
